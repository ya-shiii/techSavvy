import{_ as Ve}from"./Navbar.vue.72301b0e.js";import{g as K,r as O,o as t,c as u,h as c,w as h,a as d,n as L,q as e,b0 as H,t as U,s as q,d as P,S as Te,ad as Se,e as Ue,a1 as J,F as w,m as D,P as ee,at as we,l as g,b as x,J as ue,j as ie,E as de,V as je,ai as le,T as qe,al as Ne,a6 as ce,I as W,ah as Ee,b1 as Pe,z as pe,b2 as Le,D as Oe,b3 as Ie,Z as Be,b4 as De,a8 as Me}from"./entry.559460ac.js";import{_ as me}from"./Badge.e05fc69f.js";import{_ as fe}from"./NSelect.vue.38f0d91b.js";import{_ as Fe}from"./CodeSnippets.vue.a1fe908d.js";import{_ as Ae}from"./NCheckbox.vue.660c8c34.js";import{_ as he}from"./NPanelGrids.cfd60e85.js";import{_ as We}from"./NCodeBlock.vue.12f6d4d2.js";import{C as re}from"./constants.d7bcda3c.js";import{U as ze}from"./json-editor-vue.9acffc14.js";import{_ as Ge}from"./PanelLeftRight.vue.d1539d19.js";import"./client.1e3208e3.js";const He=d("div",{"x-divider":""},null,-1),ve=K({__name:"ServerRouteListItem",props:{item:{},index:{default:0}},setup(I){const N=O(!0);return(l,f)=>{const s=ee,E=me,j=ve;return t(),u("div",null,[(t(),c(Se(l.item.routes?"button":e(Ue)),{flex:"~ gap-2","w-full":"","items-center":"","hover-bg-active":"",px2:"",py1:"",class:L([{"bg-active":l.$route.query.path===l.item.route&&l.$route.query.method===l.item.method}]),style:Te({paddingLeft:`calc(0.5rem + ${l.index*1.5}em)`}),to:{query:{path:l.item.route,method:l.item.method}},onClick:f[0]||(f[0]=T=>N.value=!e(N))},{default:h(()=>[d("div",{class:L({"w-12":!l.item.routes}),"flex-none":"","text-left":""},[l.item.type==="collection"?(t(),c(s,{key:0,icon:"carbon:chevron-right","mb0.5":"","transform-rotate":e(N)?90:0,transition:""},null,8,["transform-rotate"])):(t(),c(E,{key:1,class:L(("getRequestMethodClass"in l?l.getRequestMethodClass:e(H))(l.item.method||"*")),textContent:U((l.item.method||"*").toUpperCase())},null,8,["class","textContent"]))],2),d("span",{class:L({"flex items-center":l.item.routes}),"flex-auto":"","text-sm":"","font-mono":""},[l.item.type==="collection"?(t(),c(s,{key:0,title:`${l.item.routes?.length} routes`,icon:"carbon:folder",mr1:""},null,8,["title"])):q("",!0),P(" "+U(l.item.route),1)],2)]),_:1},8,["class","style","to"])),He,e(N)?J(l.$slots,"default",{key:0},()=>[(t(!0),u(w,null,D(l.item.routes,T=>(t(),c(j,{key:T.filepath,item:T,index:l.index+1},null,8,["item","index"]))),128))]):q("",!0)])}}}),Je={p4:"",flex:"~ col gap-4"},Ke={key:1,ml2:"",flex:""},Qe=["value"],Ze={flex:"","gap-4":""},Xe=d("div",{"flex-auto":""},null,-1),Ye=K({__name:"ServerRouteInputs",props:{modelValue:{},keys:{default:()=>[]},default:{default:()=>({})},exclude:{default:()=>[]}},setup(I,{emit:N}){const l=I,f=we(l,"modelValue",N,{passive:!0}),s=g(()=>[...[...l.keys,"key","value","type"].filter(R=>!l.exclude.includes(R))]),E=g(()=>{const b={};for(const R of s.value)b[R]=l.default[R]||"";return b}),j=["string","number","boolean","file","date","time","datetime-local"];function T(b,R){const p=R.target;if(p.files&&p.files[0]){const v=p.files[0],k=new FileReader;k.readAsDataURL(v),k.onload=()=>{f[b].value=k.result}}}return(b,R)=>{const p=ue,v=Ae,k=fe,C=ee,_=ie;return t(),u("div",Je,[(t(!0),u(w,null,D(e(f),(i,$)=>(t(),u("div",{key:$,flex:"~ gap-2","justify-around":""},[J(b.$slots,"input",{item:i}),(t(!0),u(w,null,D(e(s),y=>(t(),u(w,{key:y},[i?.type!==null&&y==="key"?(t(),c(p,{key:0,modelValue:i[y],"onUpdate:modelValue":r=>i[y]=r,placeholder:y,"flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue","placeholder"])):y!=="type"?(t(),u(w,{key:1},[i.type==="file"?(t(),c(p,{key:0,type:"file",onChange:r=>T($,r)},null,8,["onChange"])):i.type==="boolean"?(t(),u("div",Ke,[x(v,{modelValue:i.value,"onUpdate:modelValue":r=>i.value=r,placeholder:"Value",n:"green lg"},null,8,["modelValue","onUpdate:modelValue"])])):(t(),c(p,{key:2,modelValue:i.value,"onUpdate:modelValue":r=>i.value=r,type:i.type,placeholder:"Value","flex-1":"","font-mono":"",n:"sm"},null,8,["modelValue","onUpdate:modelValue","type"]))],64)):y==="type"?(t(),c(k,{key:2,modelValue:i.type,"onUpdate:modelValue":r=>i.type=r,n:"sm green"},{default:h(()=>[(t(),u(w,null,D(j,r=>d("option",{key:r,value:r},U(r),9,Qe)),64))]),_:2},1032,["modelValue","onUpdate:modelValue"])):q("",!0)],64))),128)),J(b.$slots,"input-actions",{},()=>[x(_,{n:"red",onClick:y=>e(f).splice($,1)},{default:h(()=>[x(C,{icon:"carbon:delete"})]),_:2},1032,["onClick"])])]))),128)),d("div",Ze,[J(b.$slots,"actions",{params:e(f)},()=>[x(_,{icon:"carbon-add",n:"sm primary",my1:"","px-3":"",onClick:R[0]||(R[0]=i=>e(f).push({...e(E)}))},{default:h(()=>[P(" Add ")]),_:1}),Xe,e(f).length?(t(),c(_,{key:0,icon:"carbon-trash-can",n:"sm red",my1:"","px-3":"",onClick:R[1]||(R[1]=i=>f.value=[])},{default:h(()=>[P(" Remove All ")]),_:1})):q("",!0)])])])}}}),et={"h-full":"","w-full":"",flex:"~ col"},tt={flex:"~ col gap-2","flex-none":"",p4:"","navbar-glass":""},ot={flex:"~ gap2"},nt={flex:"~ gap2","w-full":"","items-center":"",px4:"",pb2:"","text-center":"","text-sm":"",border:"b base"},st=d("div",{"flex-auto":""},null,-1),at={key:0,border:"b base","items-center":"",px4:"",py2:"",grid:"~ cols-[max-content_1fr] gap-2"},lt={"text-right":"","font-mono":""},rt={key:1,relative:""},ut={key:2,relative:"","n-code-block":"",border:"b base"},it={flex:"~ wrap","w-full":""},dt=["onClick"],ct=d("div",{border:"b base","flex-auto":""},null,-1),pt={border:"b base",flex:"~ gap2","items-center":"",px4:"",py2:""},mt=d("div",null,"Response",-1),ft={key:1,"text-xs":"",op50:""},ht=d("div",{"flex-auto":""},null,-1),vt=d("div",{op50:""}," Request finished in ",-1),_t={key:0,"flex-auto":"","overflow-auto":""},yt={border:"~ base","h-full":"","w-full":"",rounded:""},gt=["data"],bt={key:2,"flex-auto":"","overflow-auto":"",p4:""},kt={border:"~ base",rounded:""},Ct=["src"],$t={key:1,controls:"",rounded:""},xt=["src"],Rt=K({__name:"ServerRouteDetails",props:{route:{}},setup(I){const N=I,l=de(),f=je(),s=le({contentType:"text/plain",data:"",statusCode:200,error:void 0,fetchTime:0}),E=g(()=>s.contentType.includes("application/json")?"json":s.contentType.includes("text/html")?"html":s.contentType.includes("text/css")?"css":s.contentType.includes("text/javascript")?"javascript":s.contentType.includes("image")||s.contentType.includes("video")?"media":s.contentType.includes("text/xml")||s.contentType.includes("application/xml")?"xml":s.contentType.includes("application/pdf")?"pdf":"text"),j=g(()=>{if(E.value==="json")return JSON.stringify(s.data,null,2);if(E.value==="media"||E.value==="pdf"){const o=new Blob([s.data],{type:s.contentType});return URL.createObjectURL(o)}return s.data}),T=O(!1),b=O(!1),R=qe(),p=g(()=>N.route.route?.split(/((?:\*\*)?:[\w_]+)/g)),v=g(()=>p.value?.filter(o=>o.startsWith(":")||o.startsWith("**:"))||[]),k=O(N.route.method||"GET"),C=O({}),_=le({query:[{key:"",value:"",type:"string"}],body:[{key:"",value:"",type:"string"}],headers:[{key:"Content-Type",value:"application/json",type:"string"}]}),i=O({}),$=["GET","POST","PUT","PATCH","DELETE","HEAD"],y=["PATCH","POST","PUT","DELETE"],r=g(()=>y.includes(k.value.toUpperCase())),V=O(l.query.tab?l.query.tab:v.value.length?"params":"query"),te=["input","json"],A=O(te[0]),M=g({get:()=>_[V.value],set:o=>{_[V.value]=o}}),oe=g(()=>({...Z(_.query)})),ye=g(()=>({...Z(_.headers)})),Q=g(()=>r.value?A.value==="json"?i.value:{...Z(_.body)}:void 0),ge=g(()=>{let o=f.value?.devServer.url||"http://localhost";o.charAt(o.length-1)==="/"&&(o=o.slice(0,-1));const n=f.value?.devServer.port||3e3;return o.includes(`:${n}`)?o:`${o}:${n}`}),z=g(()=>{let o=new URLSearchParams(oe.value).toString();o&&(o=`?${o}`);const n=(p.value?.map(S=>(S.startsWith(":")||S.startsWith("**:"))&&C.value[S]||S).join("")||"")+o;let m=f.value?.app.baseURL||"";return(m==="./"||m===".")&&(m=""),m.endsWith("/")&&(m=m.slice(0,-1)),m+n}),be=g(()=>ge.value+z.value);function Z(o){const n=Object.fromEntries(o.filter(({key:m,value:S})=>m&&S!==void 0).map(({key:m,value:S})=>[m,S]));return Object.entries(n).length?n:void 0}async function ne(){b.value=!0,T.value=!0;const o=Date.now();try{s.data=await $fetch(be.value,{method:k.value.toUpperCase(),headers:ye.value,query:oe.value,body:Q.value,onResponse({response:n}){s.contentType=(n.headers.get("content-type")||"").toString().toLowerCase().trim(),s.statusCode=n.status},onResponseError(n){s.error=n.response._data,s.data=n.response._data}})}catch{}T.value=!1,s.fetchTime=Date.now()-o}const se=g(()=>{const o=[],n=[],m=_.headers.filter(({key:B,value:F})=>B&&F&&!(B==="Content-Type"&&F==="application/json")).map(({key:B,value:F})=>`  '${B}': '${F}'`).join(`,
`);k.value.toUpperCase()!=="GET"&&n.push(`method: '${k.value.toUpperCase()}'`),m&&n.push(`headers: {
${m}
}`),Q.value&&n.push(`body: ${JSON.stringify(Q.value,null,2)}`);const S=n.length?`, {
${n.join(`,
`).split(`
`).map(B=>`  ${B}`).join(`
`)}
}`:"";return o.push({name:"useFetch",lang:"javascript",docs:re.nuxt.useFetch,code:`const { data, pending, error, refresh } = useFetch('${z.value}'${S})`}),o.push({name:"$fetch",lang:"javascript",docs:re.nuxt.$fetch,code:`await $fetch('${z.value}'${S})`}),o}),ke=g(()=>{const o=[];return v.value.length&&o.push({name:"Params",slug:"params",icon:"carbon-text-selection",length:v.value.length}),o.push({name:"Query",slug:"query",icon:"carbon-help",length:_.query.length}),r.value&&o.push({name:"Body",slug:"body",icon:"carbon-document",length:_.body.length}),o.push({name:"Headers",slug:"headers",icon:"carbon-html-reference",length:_.headers.length}),o.push({name:"Snippets",slug:"snippet",icon:"carbon-code"}),o});Ne(()=>{A.value==="json"&&typeof i.value=="string"&&(i.value=JSON.parse(i.value))});const G=[];return ce(M,o=>{o&&o.forEach((n,m)=>{G.length?G[m]!==n.type&&n.type!==void 0&&(G[m]=n.type,n.type!=="string"?n.type==="boolean"&&typeof n.value!="boolean"?n.value=!0:n.type==="number"&&typeof n.value!="number"?n.value=0:n.value="":n.type==="string"&&(n.value=n.value.toString())):G[m]=n.type??"string"})},{immediate:!0,deep:!0}),(o,n)=>{const m=ie,S=fe,B=ue,F=ee,Ce=Fe,ae=Ye,$e=he,xe=Pe,X=me,Re=We;return t(),u("div",et,[d("div",tt,[d("div",ot,[o.route.method?(t(),c(m,{key:0,class:L(("getRequestMethodClass"in o?o.getRequestMethodClass:e(H))(e(k))),"pointer-events-none":"",tabindex:"-1"},{default:h(()=>[P(U(e(k).toUpperCase()),1)]),_:1},8,["class"])):(t(),c(S,{key:1,modelValue:e(k),"onUpdate:modelValue":n[0]||(n[0]=a=>W(k)?k.value=a:null),class:L(("getRequestMethodClass"in o?o.getRequestMethodClass:e(H))(e(k)))},{default:h(()=>[(t(),u(w,null,D($,a=>d("option",{key:a,class:L(("getRequestMethodClass"in o?o.getRequestMethodClass:e(H))(a))},U(a.toUpperCase()),3)),64))]),_:1},8,["modelValue","class"])),x(B,{"model-value":e(z),disabled:"","flex-auto":"","font-mono":"",p:"x5 y2",n:"primary xs"},null,8,["model-value"]),x(m,{n:"primary solid",onClick:ne},{default:h(()=>[x(F,{icon:"carbon:send"})]),_:1})])]),d("div",nt,[(t(!0),u(w,null,D(e(ke),a=>(t(),c(m,{key:a.slug,class:L(e(V)===a.slug?"text-primary n-primary":"border-transparent shadow-none"),onClick:Y=>V.value=a.slug},{default:h(()=>[x(F,{icon:a.icon},null,8,["icon"]),P(" "+U(a.name)+" "+U(a?.length?`(${a.length})`:""),1)]),_:2},1032,["class","onClick"]))),128)),st,x(m,{icon:"carbon-launch",onClick:n[1]||(n[1]=a=>e(R)(o.route.filepath))},{default:h(()=>[P(" Open in Editor ")]),_:1})]),e(V)==="params"?(t(),u("div",at,[(t(!0),u(w,null,D(e(v),a=>(t(),u(w,{key:a},[d("div",lt,U(a),1),x(B,{modelValue:e(C)[a],"onUpdate:modelValue":Y=>e(C)[a]=Y,placeholder:a,"flex-1":""},null,8,["modelValue","onUpdate:modelValue","placeholder"])],64))),128))])):q("",!0),e(V)==="snippet"?(t(),u("div",rt,[e(se).length?(t(),c(Ce,{key:0,border:"b base","code-snippets":e(se)},null,8,["code-snippets"])):q("",!0)])):e(M)?(t(),u("div",ut,[e(V)==="body"?(t(),u(w,{key:0},[d("div",it,[(t(),u(w,null,D(te,a=>d("button",{key:a,px4:"",py2:"",border:"r base",hover:"bg-active",class:L({"border-b":a!==e(A)}),onClick:Y=>A.value=a},[d("div",{class:L({op30:a!==e(A)}),"font-mono":""},U(a),3)],10,dt)),64)),ct]),e(A)==="input"?(t(),c(ae,{key:0,modelValue:e(M),"onUpdate:modelValue":n[2]||(n[2]=a=>W(M)?M.value=a:null),default:{type:"string"}},null,8,["modelValue"])):e(A)==="json"?(t(),c(e(ze),Ee({key:1,modelValue:e(i),"onUpdate:modelValue":n[3]||(n[3]=a=>W(i)?i.value=a:null),class:[[o.$colorMode.value==="dark"?"jse-theme-dark":"light"],"json-editor-vue of-auto text-sm outline-none"]},o.$attrs,{mode:"text","navigation-bar":!1,indentation:2,"tab-size":2}),null,16,["modelValue","class"])):q("",!0)],64)):(t(),c(ae,{key:1,modelValue:e(M),"onUpdate:modelValue":n[4]||(n[4]=a=>W(M)?M.value=a:null),default:{type:"string"}},null,8,["modelValue"]))])):q("",!0),e(b)?e(T)?(t(),c(xe,{key:4,"z-10":"","flex-auto":"","backdrop-blur":""},{default:h(()=>[P(" Fetching... ")]),_:1})):(t(),u(w,{key:5},[d("div",pt,[mt,e(s).error?(t(),c(X,{key:0,"bg-red-400:10":"","text-red-400":""},{default:h(()=>[P(" Error ")]),_:1})):q("",!0),x(X,{class:L({"bg-orange-400:10 text-orange-400":e(s).error,"bg-green-400:10 text-green-400":!e(s).error})},{default:h(()=>[P(U(e(s).statusCode),1)]),_:1},8,["class"]),e(s).contentType?(t(),u("code",ft,U(e(s).contentType),1)):q("",!0),ht,vt,x(X,{"bg-green-400:10":"","text-green-400":""},{default:h(()=>[P(U(e(s).fetchTime)+" ms ",1)]),_:1})]),e(E)==="pdf"?(t(),u("div",_t,[d("div",yt,[d("object",{data:e(j),type:"application/pdf","flex-auto":"",width:"100%",height:"100%",rounded:""},null,8,gt)])])):e(E)!=="media"?(t(),c(Re,{key:1,"flex-auto":"","overflow-auto":"","py-2":"",code:e(j),lang:e(E)},null,8,["code","lang"])):(t(),u("div",bt,[d("div",kt,[e(s).contentType.includes("image")?(t(),u("img",{key:0,rounded:"",src:e(j)},null,8,Ct)):(t(),u("video",$t,[d("source",{src:e(j),type:"video/mp4"},null,8,xt)]))])]))],64)):(t(),c($e,{key:3},{default:h(()=>[x(m,{n:"primary",onClick:ne},{default:h(()=>[x(F,{icon:"carbon:send"}),P(" Send request ")]),_:1})]),_:1}))])}}}),_e=O(await pe.getOptions("serverRoutes")),Vt=Le(_e),Tt={serverRoutes:Vt};function St(I){return Tt[I]}ce(_e,async I=>{pe.updateOptions("serverRoutes",I)},{deep:!0,flush:"post"});const Ut={flex:"~ gap1","text-sm":""},wt={key:0,op50:""},jt={op50:""},qt=d("span",{op75:""},"Select a route to start",-1),zt=K({__name:"server-routes",setup(I){const N=de(),l=Oe(),f=Ie(),s=g(()=>{const p=[],v=(C,_)=>{C.routes=C.routes||[],C.routes.push(_)};return f.value?.forEach(C=>{const _=C.filepath.split("/"),i=_.slice(0,-1).slice(_.indexOf("server")+1);let $=null;if(i.forEach(y=>{const r=$?$.routes?.find(V=>V.route===y):p.find(V=>V.route===y);if(r)$=r;else{const V={route:y,filepath:y.replace(/\W/g,"-").toLowerCase(),type:"collection",routes:[]};$?v($,V):p.push(V),$=V}}),C.type==="runtime"){const y=p.find(r=>r.route==="runtime");if(y)v(y,C);else{const r={route:"runtime",filepath:"runtime",type:"collection",routes:[C]};p.push(r)}}else $?v($,C):p.push(C)}),p.length===1?p[0].routes??[]:p}),E=g(()=>new Be(f.value||[],{keys:["method","route"],shouldSort:!0})),{selectedRoute:j}=St("serverRoutes"),T=g(()=>{const p=f.value?.find(v=>v.route===N.query?.path&&v.method===N.query?.method);return p&&(j.value=p),j.value&&l.push({query:{path:j.value.route,method:j.value.method}}),p}),b=O(""),R=g(()=>f.value?b.value?E.value.search(b.value).map(v=>v.item):f.value:[]);return(p,v)=>{const k=Ve,C=ve,_=Rt,i=Me,$=he,y=Ge;return t(),c(y,{"storage-key":"tab-server-routes"},{left:h(()=>[x(k,{search:e(b),"onUpdate:search":v[0]||(v[0]=r=>W(b)?b.value=r:null),pb2:""},{default:h(()=>[d("div",Ut,[e(b)?(t(),u("span",wt,U(e(R).length)+" matched · ",1)):q("",!0),d("span",jt,U(e(f)?.length)+" routes in total",1)])]),_:1},8,["search"]),(t(!0),u(w,null,D(e(s),r=>(t(),c(C,{key:r.filepath,item:r},null,8,["item"]))),128))]),right:h(()=>[(t(),c(De,{max:10},[e(T)?(t(),c(_,{key:e(T).filepath,route:e(T)},null,8,["route"])):q("",!0)],1024)),e(T)?q("",!0):(t(),c($,{key:0},{default:h(()=>[x(i,{px6:"",py2:""},{default:h(()=>[qt]),_:1})]),_:1}))]),_:1})}}});export{zt as default};
